<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://xmlns.jcp.org/jsf/core"
        xmlns:h="http://xmlns.jcp.org/jsf/html"
        xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
        xmlns:p="http://primefaces.org/ui"
        xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
        xmlns:c="http://java.sun.com/jsp/jstl/core"
>


    <!-- MAIN PAGE COVER. -->
    <div class="section section-cover hide-for-small-only"
         style="background: url(../../resources/images/main-page-cover-16-9-1.jpg);">
    </div> <!-- END OF MAIN PAGE COVER. -->


    <!-- PAGE TITLE. -->
    <div class="row medium-6 large-8 columns text-center section">
        <h1 class="section-title">PAGRINDINĖS PREKĖS</h1>
    </div> <!-- END OF PAGE TITLE. -->


    <!-- SEARCH ITEMS BAR. -->
    <div class="row small-8 medium-6 large-4 columns input-group-rounded margin-top-3" id="search">
        <section class="search-bar">
            <h:form>
                <div class="input-group">
                    <h:inputText id="searchInput" class="input-group-field"
                                 value="#{productController.productSearch.title}"
                                 pt:placeholder="įveskite prekės pavadinimą" />
                    <div class="input-group-button">
                        <h:commandButton class="button" value="Ieškoti">
                            <f:ajax execute="searchInput"
                                    listener="#{productController.searchProducts()}"
                                    render="productList paging-form"/>
                        </h:commandButton>
                    </div>
                </div>
            </h:form>
        </section>
    </div> <!-- END OF SEARCH ITEMS BAR. -->


    <!-- [Mobile] OFF-CANVAS PRODUCT FILTER -->
    <div class="row hide-for-medium">
        <div class="off-canvas-wrapper">
            <div id="product-filter-canvas" class="off-canvas position-left" data-off-canvas="">

                <!-- [Mobile] PRICE FILTER -->
                <div class="columns small-12 margin-top-1">
                    <h5 class="text-center font-bold">Kaina</h5>

                    <ul class="categories-menu menu vertical nested is-active filter-price-menu">
                        <h:form>
                            <!--Minimum price input-->
                            <li>
                                <span class="input-group-label">Nuo</span>
                                <h:inputText class="input-group-field"
                                    pt:type="number"
                                    pt:min="0"
                                    pt:placeholder="10"
                                    value="#{productController.minPrice}"/>
                            </li>

                            <!--Maximum price input-->
                            <li class="margin-top-1">
                                <span class="input-group-label">Iki</span>
                                <h:inputText class="input-group-field"
                                    pt:type="number"
                                    pt:min="0"
                                    pt:placeholder="59"
                                    value="#{productController.maxPrice}"/>
                            </li>

                            <!-- [Mobile][Button] Filter by price -->
                            <li class="margin-top-1">
                                <h:commandButton class="button expanded" value="Filtruoti" pt:data-close="">
                                    <f:ajax execute="@form"
                                            listener="#{productController.searchPrice()}"
                                            render="productList paging-form"/>
                                </h:commandButton>

                            </li>
                        </h:form>
                    </ul>
                </div> <!-- END OF [Mobile] PRICE FILTER -->


                <!-- [Mobile] CATEGORY FILTER -->
                <div class="columns small-12 margin-top-2">
                    <h5 class="text-center font-bold"> Kategorija </h5>

                    <ul class="categories-menu menu vertical nested is-active">

                        <li>
                            <input id="category-checkbox-mobile1" type="checkbox"/>
                            <label for="category-checkbox-mobile1">
                                Category 1
                            </label>
                        </li>

                        <li>
                            <input id="category-checkbox-mobile2" type="checkbox"/>
                            <label for="category-checkbox-mobile2">
                                Category 2
                            </label>
                        </li>

                        <li>
                            <input id="category-checkbox-mobile3" type="checkbox"/>
                            <label for="category-checkbox-mobile3">
                                Category 3
                            </label>
                        </li>

                        <li>
                            <input id="category-checkbox-mobile4" type="checkbox"/>
                            <label for="category-checkbox-mobile4">
                                Category 4
                            </label>
                        </li>

                        <li>
                            <input id="category-checkbox-mobile5" type="checkbox"/>
                            <label for="category-checkbox-mobile5">
                                Category 5
                            </label>
                        </li>

                    </ul>

                    <!-- [Button][Mobile] Filter by categories -->
                    <button type="button" class="button expanded margin-top-1" data-close="">
                        Filtruoti
                    </button>

                </div> <!-- END OF [Mobile] CATEGORY FILTER -->


                <!-- [Mobile] SUB-CATEGORY FILTER -->
                <div class="columns small-12 margin-top-2">
                    <h5 class="text-center font-bold"> Sub-kategorija </h5>

                    <ul class="categories-menu menu vertical nested is-active">

                        <li>
                            <input id="sub-category-checkbox-mobile1" type="checkbox"/>
                            <label for="sub-category-checkbox-mobile1">
                                Sub-category 1
                            </label>
                        </li>

                        <li>
                            <input id="sub-category-checkbox-mobile2" type="checkbox"/>
                            <label for="sub-category-checkbox-mobile2">
                                Sub-category 2
                            </label>
                        </li>

                        <li>
                            <input id="sub-category-checkbox-mobile3" type="checkbox"/>
                            <label for="sub-category-checkbox-mobile3">
                                Sub-category 3
                            </label>
                        </li>

                        <li>
                            <input id="sub-category-checkbox-mobile4" type="checkbox"/>
                            <label for="sub-category-checkbox-mobile4">
                                Sub-category 4
                            </label>
                        </li>

                        <li>
                            <input id="sub-category-checkbox-mobile5" type="checkbox"/>
                            <label for="sub-category-checkbox-mobile5">
                                Sub-category 5
                            </label>
                        </li>

                    </ul>

                    <!-- [Button][Mobile] Filter by sub-categories -->
                    <button type="button" class="button expanded margin-top-1" data-close="">
                        Filtruoti
                    </button>

                </div> <!-- END OF [Mobile] SUB-CATEGORY FILTER -->


                <!-- [Mobile] ATTRIBUTE FILTER -->
                <div class="columns small-12 margin-top-2">
                    <h5 class="text-center font-bold"> Požymiai </h5>

                    <ul class="categories-menu menu vertical nested is-active">

                        <li>
                            <input id="attribute-checkbox-mobile1" type="checkbox"/>
                            <label for="attribute-checkbox-mobile1">
                                Attribute 1
                            </label>
                        </li>

                        <li>
                            <input id="attribute-checkbox-mobile2" type="checkbox"/>
                            <label for="attribute-checkbox-mobile2">
                                Attribute 2
                            </label>
                        </li>

                        <li>
                            <input id="attribute-checkbox-mobile3" type="checkbox"/>
                            <label for="attribute-checkbox-mobile3">
                                Attribute 3
                            </label>
                        </li>

                        <li>
                            <input id="attribute-checkbox-mobile4" type="checkbox"/>
                            <label for="attribute-checkbox-mobile4">
                                Attribute 4
                            </label>
                        </li>

                        <li>
                            <input id="attribute-checkbox-mobile5" type="checkbox"/>
                            <label for="attribute-checkbox-mobile5">
                                Attribute 5
                            </label>
                        </li>

                    </ul>

                    <!-- [Button][Mobile] Filter by attribute -->
                    <button type="button" class="button expanded margin-top-1" data-close="">
                        Filtruoti
                    </button>

                </div> <!-- END OF [Mobile] ATTRIBUTE FILTER -->

            </div>
        </div>

        <!-- [Mobile][Button] Show off-canvas filter -->
        <div class="columns small-12">
            <button type="button" class="button expanded" data-toggle="product-filter-canvas">
                Filtruoti prekes
            </button>
        </div>

    </div><!-- END OF [MOBILE] OFF-CANVAS PRODUCT FILTER -->



    <!-- MAIN SECTION -->
    <div class="row expanded">


        <!-- FILTERING -->
        <aside class="product-filters medium-3 large-2 columns hide-for-small-only">
            <div data-sticky-container="">
                <div class="sticky" data-sticky="" data-top-anchor="search">
                    <br/>
                    <ul id="filter-aside" class="vertical menu"  data-accordion-menu="">


                        <!-- Filter by price -->
                        <li class="product-filters-tab margin-top-1">
                            <h5 class="text-center font-bold "> Kaina </h5>
                            <ul class="categories-menu menu vertical nested is-active">
                                <h:form>

                                    <!-- Minimum price input -->
                                    <li>
                                        <div class="input-group">
                                            <span class="input-group-label">Nuo</span>
                                            <h:inputText class="input-group-field"
                                                 pt:type="number"
                                                 pt:min="0"
                                                 pt:placeholder="9"
                                                 value="#{productController.minPrice}"/>
                                        </div>
                                    </li>

                                    <!-- Maximum price input -->
                                    <li>
                                        <div class="input-group">
                                            <span class="input-group-label">Iki</span>
                                            <h:inputText class="input-group-field"
                                                 pt:type="number"
                                                 pt:min="0"
                                                 pt:placeholder="59"
                                                 value="#{productController.maxPrice}"/>
                                        </div>
                                    </li>

                                    <!-- [Button] Filter by price -->
                                    <li>
                                        <h:commandButton class="button expanded" value="Filtruoti">
                                            <f:ajax execute="@form"
                                                    listener="#{productController.searchPrice()}"
                                                    render="productList paging-form"/>
                                        </h:commandButton>
                                    </li>

                                </h:form>
                            </ul>
                        </li> <!-- End of filter by price -->


                        <!-- Filter by categories -->
                        <li class="margin-top-3">
                            <h5 class="text-center font-bold "> Kategorija </h5>
                            <ul class="menu vertical nested is-active">
                                <li>
                                    <input id="category-checkbox1" type="checkbox"/>
                                    <label for="category-checkbox1">
                                        Sportiniai
                                    </label>
                                </li>

                                <li>
                                    <input id="category-checkbox2" type="checkbox"/>
                                    <label for="category-checkbox2">
                                        Proginiai
                                    </label>
                                </li>

                                <li>
                                    <input id="category-checkbox3" type="checkbox"/>
                                    <label for="category-checkbox3">
                                        Laisvalaikio
                                    </label>
                                </li>

                                <li>
                                    <input id="category-checkbox4" type="checkbox"/>
                                    <label for="category-checkbox4">
                                        Šventėms
                                    </label>
                                </li>

                                <!-- [Button] Filter by category -->
                                <li>
                                    <button type="button" class="button expanded margin-top-1">
                                        Filtruoti
                                    </button>
                                </li>
                            </ul>
                        </li> <!-- End of filter by category -->


                        <!-- Filter by sub-category -->
                        <li class="margin-top-3">
                            <h5 class="text-center font-bold "> Sub-kategorija </h5>
                            <ul class="menu vertical nested is-active">
                                <li>
                                    <input id="sub-category-checkbox1" type="checkbox"/>
                                    <label for="sub-category-checkbox1">
                                        Sub-sportiniai
                                    </label>
                                </li>

                                <li>
                                    <input id="sub-category-checkbox2" type="checkbox"/>
                                    <label for="sub-category-checkbox2">
                                        Sub-proginiai
                                    </label>
                                </li>

                                <li>
                                    <input id="sub-category-checkbox3" type="checkbox"/>
                                    <label for="sub-category-checkbox3">
                                        Sub-laisvalaikio
                                    </label>
                                </li>

                                <li>
                                    <input id="sub-category-checkbox4" type="checkbox"/>
                                    <label for="sub-category-checkbox4">
                                        Sub-šventėms
                                    </label>
                                </li>

                                <!-- [Button] Filter by sub-category -->
                                <li>
                                    <button type="button" class="button expanded margin-top-1">
                                        Filtruoti
                                    </button>
                                </li>
                            </ul>
                        </li> <!-- End of filter by sub-category -->


                        <!-- Filter by attributes -->
                        <li class="margin-top-3">
                            <h5 class="text-center font-bold "> Požymiai </h5>
                            <ul class="menu vertical nested is-active">
                                <li>
                                    <input id="attribute-checkbox1" type="checkbox"/>
                                    <label for="attribute-checkbox1">
                                        Atributas 1
                                    </label>
                                </li>

                                <li>
                                    <input id="attribute-checkbox2" type="checkbox"/>
                                    <label for="attribute-checkbox2">
                                        Atributas 2
                                    </label>
                                </li>

                                <li>
                                    <input id="attribute-checkbox3" type="checkbox"/>
                                    <label for="attribute-checkbox3">
                                        Atributas 3
                                    </label>
                                </li>

                                <li>
                                    <input id="attribute-checkbox4" type="checkbox"/>
                                    <label for="attribute-checkbox4">
                                        Atributas 4
                                    </label>
                                </li>

                                <!-- [Button] Filter by attributes -->
                                <li>
                                    <button type="button" class="button expanded margin-top-1">
                                        Filtruoti
                                    </button>
                                </li>
                            </ul>
                        </li> <!-- End of filter by attributes -->

                    </ul>
                </div>
            </div>
        </aside> <!-- END OF FILTERING. -->


        <!-- PRODUCT LIST. -->
        <div class="small-12 medium-9 large-8 columns">
            <h:panelGroup id="productList">
                <ui:repeat value="#{productController.productsPage.content}" var="productItem"
                           varStatus="loop">
                    <h:outputText value="&lt;div class='row small-up-2 large-up-4 section'&gt;"
                                  escape="false" rendered="#{loop.index % 4 == 0}"/>

                    <div class="column product-box">
                        <!-- Product image -->
                        <a href="../../product-details.xhtml?productId=#{productItem.id}">
                            <p:graphicImage class="thumbnail" value="#{imageStreamer.image}">
                                <f:param name="id" value="#{productItem.images.get(0).id}"/>
                            </p:graphicImage>
                        </a>

                        <!-- Product name -->
                        <h5 class="product-name bor-bot">#{productItem.title}</h5>


                        <!-- IF THE PRODUCT IS NOT ON SALE - SHOW THIS -->
                        <!--&lt;!&ndash; Product price &ndash;&gt;-->
                        <!--<p class="product-price">€ #{productItem.price}</p>-->

                        <!-- IF THE PRODUCT IS ON SALE - SHOW THIS -->
                        <div class="hide-for-small-only">
                            <!-- Product price -->
                            <p class="product-price-new">€ #{productItem.price}</p>

                            <!-- Product old price -->
                            <span class="product-price-old strike mar-bot-10">€ 59,99</span>
                        </div>

                        <!-- [Mobile] -->
                        <div class="hide-for-medium">
                            <div class="row align-center">
                                <div class="columns small-8 small-offset-2 expanded">
                                    <!-- Product old price -->
                                    <p class="product-price-mb-old strike mar-bot-5">€ 59,99</p>
                                </div>

                                <div class="columns small-12">
                                    <!-- Product price -->
                                    <p class="product-price-mb">€ #{productItem.price}</p>
                                </div>
                            </div>
                        </div> <!-- END OF PRODUCT ON SALE -->


                        <!-- [Button] To cart -->
                        <h:form>
                            <h:commandButton class="button expanded primary"
                                             value="PRIDĖTI Į KREPŠELĮ"
                                             pt:data-open="inform-user-about-adding-to-cart-modal"
                                             actionListener="#{cartController.addProductToCart(productItem.id)}">
                                <f:ajax execute="@form" render="@none"/>
                            </h:commandButton>
                        </h:form>

                        <!-- [Button][Admin] Edit product -->
                        <c:choose>
                            <c:when test="#{userService.isLoggedIn()}">
                                <c:choose>

                                    <!-- Admin logged in -->
                                    <c:when test="#{userService.getLoggedUser().getRole() == 'ADMIN'}">
                                        <a href="../../admin-edit-product.xhtml?productId=#{productItem.id}"
                                           class="button expanded">
                                            Redaguoti prekę
                                        </a>
                                    </c:when>

                                </c:choose>
                            </c:when>
                        </c:choose>

                    </div>
                    <h:outputText value="&lt;/div&gt;" escape="false"
                                  rendered="#{loop.last or (loop.index + 1) % 4 == 0}"/>
                </ui:repeat>
            </h:panelGroup>
        </div> <!-- END OF PRODUCT LIST. -->

    </div> <!-- END OF MAIN SECTION -->

    <br/>

    <!-- PAGINATION -->
    <div class="row section">
        <div class="columns small-12">
            <h:form id="paging-form">
                <nav aria-label="Pagination">
                    <ul class="pagination text-center">
                        <li class="pagination-previous">
                            <h:commandLink value="Atgal"
                                           disabled="#{productController.paging.activePage eq 0}">
                                <f:ajax execute="@form" listener="#{productController.previous}"
                                        render="productList paging-form"/>
                            </h:commandLink>
                        </li>
                        <ui:repeat value="#{productController.paging.totalPages}" var="page"
                                   varStatus="status">
                            <li>
                                <h:commandLink
                                        rendered="#{productController.paging.isPageNumberShown(status.index)}"
                                        value="#{status.index + 1}"
                                        styleClass="#{status.index eq productController.paging.activePage ? 'current' : ''}">
                                    <f:ajax execute="@form"
                                            listener="#{productController.searchProducts(status.index)}"
                                            render="productList paging-form"/>
                                </h:commandLink>
                            </li>
                        </ui:repeat>
                        <li class="pagination-next">
                            <h:commandLink value="Pirmyn"
                                           disabled="#{productController.paging.activePage + 1 eq productController.productsPage.totalPages}">
                                <f:ajax execute="@form" listener="#{productController.next}"
                                        render="productList paging-form"/>
                            </h:commandLink>
                        </li>
                    </ul>
                </nav>
            </h:form>
        </div>
    </div> <!-- END OF PAGINATION -->



    <!-- INFORM USER ABOUT ADDING TO CART MODAL -->
    <div id="inform-user-about-adding-to-cart-modal"
         class="reveal"
         data-reveal=""
         data-overlay="false"
         data-animation-in="fade-in fast">
        <div class="row">
            <div class="columns small-8 small-offset-2">
                <h4 class="form-title text-center">
                    Prekė pridėta prie jūsų krepšelio
                </h4>
                <br/>
                <div class="row">
                    <div class="columns small-12">
                        <a class="button orange expanded" data-close="">Supratau</a>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- END OF INFORM USER ABOUT ADDING TO CART MODAL -->


</ui:composition>