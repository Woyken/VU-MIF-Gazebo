<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://xmlns.jcp.org/jsf/core"
        xmlns:h="http://xmlns.jcp.org/jsf/html"
        xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
        xmlns:p="http://primefaces.org/ui">


    <div class="section">
        <h:form id="addCategoryForm">
            <div class="row align-middle margin-top-3">
                <div class="columns small-12 medium-3">
                    <h5 class="font-bold">Tėvinė kategorija</h5>
                </div>

                <div class="columns small-10 medium-8">
                    <h:selectOneMenu value="#{productCategoryController.selectedCategory}"
                                     converter="omnifaces.SelectItemsConverter"
                                     hideNoSelectionOption="true">
                        <f:selectItems value="#{productCategoryController.categories}"/>
                        <f:ajax render="@form"/>
                    </h:selectOneMenu>
                </div>

                <!-- [Button] Delete category -->
                <div class="columns small-2 medium-1">
                    <h:commandButton
                            class="button red"
                            value="✘"
                            action="#{productCategoryController.deleteCategory}"
                            disabled="#{empty productCategoryController.selectedCategory.name}">
                        <f:ajax render="@form"/>
                    </h:commandButton>
                </div>
            </div>

            <div class="row align-middle">
                <div class="columns small-12 medium-3">
                    <h5 class="font-bold">Nauja kategorija</h5>
                </div>

                <div class="columns small-10 medium-8">
                    <h:inputText value="#{productCategoryController.newCategory.name}"
                                 disabled="#{empty productCategoryController.selectedCategory}"/>
                </div>
            </div>

            <div class="row align-middle">
                <ui:repeat value="#{productCategoryController.newCategory.attributes}" var="attribute">
                    <div class="columns small-12 medium-3">
                        <h5 class="font-bold">Kategorijos požymio pavadinimas</h5>
                    </div>

                    <div class="columns small-10 medium-8">
                        <h:inputText value="#{productCategoryController.newCategory.name}"
                                     disabled="#{empty productCategoryController.selectedCategory}"/>
                        <p:outputLabel value="Požymio galimos reikšmės:"/>
                        <div style="width: 50%">
                            <ui:repeat value="#{attribute.values}" var="attributeValue">
                                <h:inputText value="#{attributeValue}"/>
                                <h:commandButton
                                        class="button green"
                                        value="✓"
                                        action="#{productCategoryController.addNewAttributeValue(attribute, attributeValue)}">
                                    <f:ajax render="@form"/>
                                </h:commandButton>
                                <h:commandButton
                                        class="button red"
                                        value="✘"
                                        action="#{productCategoryController.removeNewAttributeValue(attribute, attributeValue)}">
                                    <f:ajax render="@form"/>
                                </h:commandButton>
                            </ui:repeat>
                        </div>
                    </div>
                    <h:commandButton
                            class="button green"
                            value="✓"
                            action="#{productCategoryController.addNewAttribute}">
                        <f:ajax render="@form"/>
                    </h:commandButton>
                    <h:commandButton
                            class="button red"
                            value="✘"
                            action="#{productCategoryController.removeNewAttribute(attribute)}">
                        <f:ajax render="@form"/>
                    </h:commandButton>
                </ui:repeat>
            </div>

            <!-- Buttons -->
            <div class="row align-middle section">
                <h:commandButton
                        class="button expanded success"
                        value="Išsaugoti">
                    <f:ajax render="@form" listener="#{productCategoryController.saveNewCategory}"/>
                </h:commandButton>
            </div>

        </h:form>

    </div>

</ui:composition>