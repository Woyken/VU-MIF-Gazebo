<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://xmlns.jcp.org/jsf/core"
        xmlns:h="http://xmlns.jcp.org/jsf/html"
        xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
        xmlns:p="http://primefaces.org/ui">


    <div class="section">
        <!-- New category -->
        <h:form id="addCategoryForm">
            <div class="row align-middle">

                <div class="columns small-12 medium-3">
                    <h5 class="font-bold">Pridėti naują kategoriją į pasirinktąją žemiau</h5>
                </div>

                <div class="columns small-10 medium-8">
                    <h:inputText value="#{productCategoryController.newCategory}"
                                 disabled="#{empty productCategoryController.selectedCategory}"/>
                </div>

                <!-- [Button] Submit new category -->
                <div class="columns small-2 medium-1">
                    <h:commandButton
                            class="button success"
                            value="✓"
                            action="#{productCategoryController.createNewCategory}"
                            disabled="#{empty productCategoryController.selectedCategory}">
                        <f:ajax execute="@form" render="@form categoryAttributesForm"/>
                    </h:commandButton>
                </div>
            </div>

            <!-- Creation Error/Success Message -->
            <div class="row-align-middle text-center">
                <div class="columns">
                    <div class="mar-bot-5">
                        <h:outputText class="alert-text-large"
                                      value="#{productCategoryController.creationErrorMessage}"/>
                        <h:outputText rendered="#{productCategoryController.isCreationSuccess}"
                                      class="success-text-large"
                                      value="Kategorija sėkmingai pridėta"/>
                    </div>
                </div>
            </div>
        </h:form>


        <h:form id="categoryAttributesForm">
            <div class="row align-middle margin-top-3">
                <div class="columns small-12 medium-3">
                    <h5 class="font-bold">Kategorija</h5>
                </div>

                <div class="columns small-10 medium-8">
                    <h:selectOneMenu value="#{productCategoryController.selectedCategory}"
                                     converter="omnifaces.SelectItemsConverter"
                                     hideNoSelectionOption="true">
                        <f:selectItem value="#{null}" itemLabel="Pasirinkite kategoriją:"
                                      noSelectionOption="true"/>
                        <f:selectItems value="#{productCategoryController.categories}"/>
                        <f:ajax render="@form addCategoryForm"/>
                    </h:selectOneMenu>
                </div>

                <!-- [Button] Delete category -->
                <div class="columns small-2 medium-1">
                    <h:commandButton
                            class="button red"
                            value="✘"
                            action="#{productCategoryController.deleteCategory}"
                            disabled="#{empty productCategoryController.selectedCategory.name}">
                        <f:ajax render="@form"/>
                    </h:commandButton>
                </div>
            </div>

            <div class="row align-middle">
                <ui:repeat value="#{productCategoryController.newCategory.attributes}" var="attribute">
                    <div class="columns small-12 medium-3">
                        <h5 class="font-bold">Kategorijos požymio pavadinimas</h5>
                    </div>

                    <div class="columns small-10 medium-8">
                        <h:inputText value="#{attribute.name}"
                                     disabled="#{empty productCategoryController.selectedCategory}"/>
                        <p:outputLabel value="Požymio galimos reikšmės:"/>
                        <div style="width: 50%">
                            <ui:repeat value="#{attribute.values}" var="attributeValue">
                                <div class="row">
                                    <div class="columns small-12 medium-9">
                                        <h:inputText value="#{attributeValue.value}"/>
                                    </div>
                                    <div class="columns small-12 medium-3">
                                        <h:commandButton
                                                class="button green"
                                                value="✓"
                                                action="#{productCategoryController.addNewAttributeValue(attribute, attributeValue)}">
                                            <f:ajax render="@form"/>
                                        </h:commandButton>
                                        <h:commandButton
                                                class="button red"
                                                value="✘"
                                                action="#{productCategoryController.removeNewAttributeValue(attribute, attributeValue)}">
                                            <f:ajax render="@form"/>
                                        </h:commandButton>
                                    </div>
                                </div>
                            </ui:repeat>
                        </div>
                    </div>
                    <div class="columns small-2 medium-1">
                        <h:commandButton
                                class="button green"
                                value="✓"
                                action="#{productCategoryController.addNewAttribute}">
                            <f:ajax render="@form"/>
                        </h:commandButton>
                        <h:commandButton
                                class="button red"
                                value="✘"
                                action="#{productCategoryController.removeNewAttribute(attribute)}">
                            <f:ajax render="@form"/>
                        </h:commandButton>
                    </div>
                </ui:repeat>
            </div>

            <!-- Buttons -->
            <div class="row align-middle section">
                <h:commandButton
                        class="button expanded success"
                        value="Išsaugoti"
                        action="#{productCategoryController.saveNewCategory}">
                    <f:ajax render="@form" execute="@form"/>
                </h:commandButton>
            </div>

        </h:form>

    </div>

</ui:composition>